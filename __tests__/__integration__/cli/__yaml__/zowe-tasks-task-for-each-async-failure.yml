global:
  myList:
    - value: 1
    - value: 2
    - value: 3

tasks:
  for-each:
    desc: "Perform this task for each of the values in 'myList' async"
    async: true
    repeat:
      forEach: ${myList}
    actions:
      - name: "increment the value"
        desc: "Increment by 1"
        action:
          type: "asyncjs"
          run: >
            cb(null, ${extracted.value} + 1)
        outputExtractor:
          - var: "theIncrement"
      - name: "validateValue"
        desc: "Validate the increment (${extracted.theIncrement})"
        action:
          type: "asyncjs"
          run: >
            if (${extracted.value} + 1 === ${extracted.theIncrement} - 1) {
              cb();
            } else {
              cb(new Error("The value did not increase!"));
            }
